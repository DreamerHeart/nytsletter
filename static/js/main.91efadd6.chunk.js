(this.webpackJsonpnytsletter=this.webpackJsonpnytsletter||[]).push([[0],{31:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),s=n(19),i=n.n(s),a=(n(31),n(6)),o=n(3),l=n(5),u=n.n(l),j=n(20),d=n(21),b=n(22),f=n(26),m=n(25),p=(n(52),n(0)),h=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(p.jsx)("article",{ref:this.props.aRef,className:"NewsItem-container",children:Object(p.jsxs)("a",{className:"NewsItem-clickable",href:this.props.url,children:[Object(p.jsx)("img",{className:"NewsItem-image",src:this.props.thumbnailStandard,alt:""}),Object(p.jsxs)("div",{className:"NewsItem-text",children:[Object(p.jsx)("span",{className:"NewsItem-publication-datetime",children:this.props.publishedDate.toLocaleString("ru-RU")})," ","- ",this.props.title]})]})})}}]),n}(r.a.Component),O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{root:null,rootMargin:"0px",threshold:1},t=arguments.length>1?arguments[1]:void 0,n=Object(c.useRef)(null),r=Object(c.useRef)((function(e,c){Object(o.a)(e,1)[0].isIntersecting&&n.current&&(c.unobserve(n.current),n.current=null,t())})),s=Object(c.useRef)(new IntersectionObserver(r.current,e)),i=Object(c.useRef)((function(e){var t,c;n.current&&(null===s||void 0===s||null===(t=s.current)||void 0===t||t.unobserve(n.current));(n.current=e,n.current)&&(null===s||void 0===s||null===(c=s.current)||void 0===c||c.observe(n.current))}));return Object(c.useEffect)((function(){var e=s.current;return function(){e.disconnect()}}),[]),[i.current]},v=(n(54),function(){return Object(p.jsx)("div",{className:"LoadingSpinner-container",children:Object(p.jsx)("div",{className:"LoadingSpinner-spinner"})})}),g=n(23),w=(n(55),function(e){var t=e.apiEndpointUrl,n=e.apiKey,r=e.source,s=e.section,i=e.topMargin,l=Object(c.useState)([]),d=Object(o.a)(l,2),b=d[0],f=d[1],m=Object(c.useRef)(0),w=Object(c.useState)(!1),N=Object(o.a)(w,2),x=N[0],y=N[1],S=Object(c.useRef)(!1),k=O(void 0,(function(){A.current()})),R=Object(o.a)(k,1)[0],A=Object(c.useRef)((function(){})),E=Object(c.useCallback)((function(e){R(e)}),[R]);return Object(c.useEffect)((function(){f([]),m.current=0,A.current=function(){S.current||m.current>=500||(S.current=!0,y(!0),u.a.get("".concat(t,"/").concat(r,"/").concat(s,".json?limit=").concat(20,"&offset=").concat(m.current,"&api-key=").concat(n)).then((function(e){var t=e.data;t.results&&(f((function(e){return[].concat(Object(a.a)(e),Object(a.a)(t.results))})),m.current+=20)})).catch((function(e){u.a.isAxiosError(e)&&(console.log("The API server responed with an error, retrying in 10 sec."),setTimeout(A.current,1e4)),console.log(e)})).finally((function(){y(!1),S.current=!1})))},A.current()}),[t,n,r,s]),Object(p.jsxs)("section",{className:Object(g.a)("NewsFeed","large"===i&&"NewsFeed-shift"),children:[b.map((function(e,t){return Object(p.jsx)(h,{aRef:t===b.length-1?E:void 0,title:e.title,url:e.url,thumbnailStandard:e.thumbnail_standard,publishedDate:new Date(e.published_date)},Object(j.v4)())})),x&&Object(p.jsx)(v,{})]})}),N=(n(56),n(57),function(e){var t=e.mode,n=e.sections,c=e.setSelectedSection;return Object(p.jsxs)("nav",{className:"NewsSectionPicker-container",children:["large"===t&&Object(p.jsx)("ul",{className:"NewsSectionPicker-large",children:n.map((function(e){return Object(p.jsx)("li",{className:"NewsSectionPicker-section",onClick:function(){c(e.section)},children:e.display_name},e.section)}))}),"large"===t&&Object(p.jsx)("div",{className:"NewsSectionPicker-small",children:Object(p.jsx)("div",{className:"select",children:Object(p.jsx)("select",{onChange:function(e){c(e.target.value)},children:n.map((function(e){return Object(p.jsx)("option",{className:"NewsSectionPicker-section",value:e.section,children:e.display_name},e.section)}))})})})]})}),x=n(24),y=n.n(x),S="https://api.nytimes.com/svc/news/v3/content",k="ywaJPS8ic04gZfBfGQVE8R35DJjOeYJh";var R=function(){var e=Object(c.useState)("large"),t=Object(o.a)(e,2),n=t[0],r=t[1];!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=Object(c.useRef)(0),i=Object(c.useRef)(!1);Object(c.useEffect)((function(){var c=function(e){var c=!1,a=!1;s.current<t&&window.scrollY>=t&&(c=!0),s.current>t&&window.scrollY<=t&&(a=!0),s.current=window.scrollY,i.current||(window.requestAnimationFrame((function(){c&&n(s.current),a&&r(s.current),i.current=!1})),i.current=!0)};return e.addEventListener("scroll",c),function(){e.removeEventListener("scroll",c)}}))}(document,100,(function(e){return r("small")}),(function(e){return r("large")}));var s=Object(c.useState)([]),i=Object(o.a)(s,2),l=i[0],j=i[1],d=Object(c.useState)("all"),b=Object(o.a)(d,2),f=b[0],m=b[1];return Object(c.useEffect)((function(){u.a.get("".concat(S,"/section-list.json?api-key=").concat(k)).then((function(e){var t=e.data.results;t=t.map((function(e){return{section:encodeURIComponent(e.section),display_name:e.display_name}})),j([{section:"all",display_name:"All"}].concat(Object(a.a)(Array.from(t).filter((function(e){return"admin"!==e.section})))))}))}),[]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("header",{className:"App-header",children:[Object(p.jsx)("h1",{className:"App-title",children:"Nytsletter"}),Object(p.jsx)(N,{mode:n,sections:l,setSelectedSection:m})]}),Object(p.jsx)("main",{className:"App-main",children:Object(p.jsx)(w,{apiEndpointUrl:S,apiKey:k,source:"nyt",section:f,topMargin:n})}),Object(p.jsxs)("footer",{className:"App-footer",children:[Object(p.jsx)(y.a,{showUnder:160,children:Object(p.jsx)("img",{className:"App-scroll-up-icon",src:"/nytsletter/img/scroll-up-icon.png",alt:"Scroll up"})}),Object(p.jsx)("img",{src:"/nytsletter/img/poweredby_nytimes_150a.png",alt:"Data provided by The New York Times"})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(R,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[62,1,2]]]);
//# sourceMappingURL=main.91efadd6.chunk.js.map