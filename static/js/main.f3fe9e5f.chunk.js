(this.webpackJsonpnytsletter=this.webpackJsonpnytsletter||[]).push([[0],{12:function(e,t,n){e.exports={"App-header":"LoadingSpinner_App-header__ikd7M","App-title":"LoadingSpinner_App-title__1Eqw3","App-main":"LoadingSpinner_App-main__VEfET","App-footer":"LoadingSpinner_App-footer__17CmQ","LoadingSpinner-container":"LoadingSpinner_LoadingSpinner-container__2YKgK","LoadingSpinner-spinner":"LoadingSpinner_LoadingSpinner-spinner__19YSl",dotSpin:"LoadingSpinner_dotSpin__1gwVU"}},13:function(e,t,n){e.exports={"App-header":"NewsFeed_App-header__1xBYX","App-title":"NewsFeed_App-title__1NMF0","App-main":"NewsFeed_App-main__1Ovgv","App-footer":"NewsFeed_App-footer__11qlj",NewsFeed:"NewsFeed_NewsFeed__2iwIL","NewsFeed-shift":"NewsFeed_NewsFeed-shift__GgUbL"}},35:function(e,t,n){},4:function(e,t,n){e.exports={"App-header":"NewsSectionPicker_App-header__26r1w","App-title":"NewsSectionPicker_App-title__2mr7D","App-main":"NewsSectionPicker_App-main__2snmN","App-footer":"NewsSectionPicker_App-footer__25bUh","NewsSectionPicker-large":"NewsSectionPicker_NewsSectionPicker-large__zDPPH","NewsSectionPicker-section-selected":"NewsSectionPicker_NewsSectionPicker-section-selected__2AD0o","NewsSectionPicker-small":"NewsSectionPicker_NewsSectionPicker-small__1P-TA",select:"NewsSectionPicker_select__1STrQ","NewsSectionPicker-container":"NewsSectionPicker_NewsSectionPicker-container__1-sXA"}},5:function(e,t,n){e.exports={"App-header":"NewsItem_App-header__3_FiB","App-title":"NewsItem_App-title__1nK3v","App-main":"NewsItem_App-main__2kRa-","App-footer":"NewsItem_App-footer__2SPBf","NewsItem-container":"NewsItem_NewsItem-container__3oTrI","NewsItem-title":"NewsItem_NewsItem-title__3TVHT","NewsItem-image":"NewsItem_NewsItem-image__1OVhg","NewsItem-publication-datetime":"NewsItem_NewsItem-publication-datetime__1dRnl","NewsItem-clickable":"NewsItem_NewsItem-clickable__3t2mI"}},61:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n.n(c),r=n(24),s=n.n(r),a=(n(35),n(8)),o=n(3),l=n(7),u=n.n(l),p=n(25),d=n.n(p),m=n(26),_=n(27),j=n(28),f=n(30),b=n(29),w=n(5),N=n.n(w),h=n(0),O=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(){return Object(_.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"render",value:function(){return Object(h.jsx)("article",{ref:this.props.aRef,className:N.a["NewsItem-container"],children:Object(h.jsxs)("a",{className:N.a["NewsItem-clickable"],href:this.props.url,children:[Object(h.jsx)("img",{className:N.a["NewsItem-image"],src:this.props.thumbnailStandard,alt:""}),Object(h.jsxs)("div",{className:N.a["NewsItem-text"],children:[Object(h.jsx)("span",{className:N.a["NewsItem-publication-datetime"],children:this.props.publishedDate.toLocaleString("ru-RU")})," ","- ",this.props.title]})]})})}}]),n}(i.a.PureComponent),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{root:null,rootMargin:"0px",threshold:1},t=arguments.length>1?arguments[1]:void 0,n=Object(c.useRef)(null),i=Object(c.useRef)((function(e,c){Object(o.a)(e,1)[0].isIntersecting&&n.current&&(c.unobserve(n.current),n.current=null,t())})),r=Object(c.useRef)(new IntersectionObserver(i.current,e)),s=Object(c.useRef)((function(e){var t,c;n.current&&(null===r||void 0===r||null===(t=r.current)||void 0===t||t.unobserve(n.current));(n.current=e,n.current)&&(null===r||void 0===r||null===(c=r.current)||void 0===c||c.observe(n.current))}));return Object(c.useEffect)((function(){var e=r.current;return function(){e.disconnect()}}),[]),[s]},S=n(12),v=n.n(S),A=function(){return Object(h.jsx)("div",{className:v.a["LoadingSpinner-container"],children:Object(h.jsx)("div",{className:v.a["LoadingSpinner-spinner"]})})},k=n(11),x=n(13),I=n.n(x),P=function(e){var t=e.apiEndpointUrl,n=e.apiKey,i=e.source,r=e.section,s=e.topMargin,l=Object(c.useState)([]),p=Object(o.a)(l,2),d=p[0],_=p[1],j=Object(c.useRef)(0),f=Object(c.useState)(!1),b=Object(o.a)(f,2),w=b[0],N=b[1],S=Object(c.useRef)(!1),v=g(void 0,(function(){P.current()})),x=Object(o.a)(v,1)[0],P=Object(c.useRef)((function(){})),y=Object(c.useCallback)((function(e){d.length<20||x.current(e)}),[x,d.length]);return Object(c.useEffect)((function(){_([]),j.current=0,P.current=function(){S.current||j.current>=500||(S.current=!0,N(!0),u.a.get("".concat(t,"/").concat(i,"/").concat(r,".json?limit=").concat(20,"&offset=").concat(j.current,"&api-key=").concat(n)).then((function(e){var t=e.data;t.results?(_((function(e){return[].concat(Object(a.a)(e),Object(a.a)(t.results))})),j.current+=20):j.current=500})).catch((function(e){u.a.isAxiosError(e)&&(console.log("The API server responed with an error, retrying in 10 sec."),setTimeout(P.current,1e4))})).finally((function(){N(!1),S.current=!1})))},P.current()}),[t,n,i,r]),Object(h.jsxs)("section",{className:Object(k.a)(I.a.NewsFeed,"large"===s&&I.a["NewsFeed-shift"]),children:[d.map((function(e,t){return Object(h.jsx)(O,{aRef:t===d.length-1?y:void 0,title:e.title,url:e.url,thumbnailStandard:e.thumbnail_standard,publishedDate:new Date(e.published_date)},Object(m.v4)())})),w&&Object(h.jsx)(A,{})]})},y=n(4),L=n.n(y),R=function(e){var t=e.mode,n=e.sections,c=e.selectedSection,i=e.setSelectedSection;return Object(h.jsxs)("nav",{className:L.a["NewsSectionPicker-container"],children:["large"===t&&Object(h.jsx)("ul",{className:L.a["NewsSectionPicker-large"],children:n.map((function(e){return Object(h.jsx)("li",{className:Object(k.a)(L.a["NewsSectionPicker-section"],c===e.section&&L.a["NewsSectionPicker-section-selected"]),onClick:function(){i(e.section)},children:e.display_name},e.section)}))}),"large"===t&&Object(h.jsx)("div",{className:L.a["NewsSectionPicker-small"],children:Object(h.jsx)("div",{className:"select",children:Object(h.jsx)("select",{onChange:function(e){i(e.target.value)},value:c,children:n.map((function(e){return Object(h.jsx)("option",{className:L.a["NewsSectionPicker-section"],value:e.section,children:e.display_name},e.section)}))})})})]})},F=(n(61),"https://api.nytimes.com/svc/news/v3/content"),E="ywaJPS8ic04gZfBfGQVE8R35DJjOeYJh";var T=function(){var e=Object(c.useState)("large"),t=Object(o.a)(e,2),n=t[0],i=t[1];!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=Object(c.useRef)(0),s=Object(c.useRef)(!1);Object(c.useEffect)((function(){var c=function(e){var c=!1,a=!1;r.current<t&&window.scrollY>=t&&(c=!0),r.current>t&&window.scrollY<=t&&(a=!0),r.current=window.scrollY,s.current||(window.requestAnimationFrame((function(){c&&n(r.current),a&&i(r.current),s.current=!1})),s.current=!0)};return e.addEventListener("scroll",c),function(){e.removeEventListener("scroll",c)}}))}(document,100,(function(e){return i("small")}),(function(e){return i("large")}));var r=Object(c.useState)([]),s=Object(o.a)(r,2),l=s[0],p=s[1],m=Object(c.useState)("all"),_=Object(o.a)(m,2),j=_[0],f=_[1];return Object(c.useEffect)((function(){u.a.get("".concat(F,"/section-list.json?api-key=").concat(E)).then((function(e){var t=e.data.results;t=t.map((function(e){return{section:encodeURIComponent(e.section),display_name:e.display_name}})),p([{section:"all",display_name:"All"}].concat(Object(a.a)(Array.from(t).filter((function(e){return"admin"!==e.section})))))}))}),[]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsxs)("header",{className:"App-header",children:[Object(h.jsx)("h1",{className:"App-title",children:"Nytsletter"}),Object(h.jsx)(R,{mode:n,sections:l,selectedSection:j,setSelectedSection:f})]}),Object(h.jsx)("main",{className:"App-main",children:Object(h.jsx)(P,{apiEndpointUrl:F,apiKey:E,source:"nyt",section:j,topMargin:n})}),Object(h.jsxs)("footer",{className:"App-footer",children:[Object(h.jsx)(d.a,{showUnder:160,children:Object(h.jsx)("img",{className:"App-scroll-up-icon",src:"/nytsletter/img/scroll-up-icon.png",alt:"Scroll up"})}),Object(h.jsx)("img",{src:"/nytsletter/img/poweredby_nytimes_150a.png",alt:"Data provided by The New York Times"})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(T,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[62,1,2]]]);
//# sourceMappingURL=main.f3fe9e5f.chunk.js.map